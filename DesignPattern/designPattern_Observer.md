# Observer Pattern이란?
객체의 **상태 변화를 관찰하는 옵저버**(감시자)들의 목록을 객체에 등록하여 **상태 변화가 있을 때마다** 메서드 등을 통해 객체가 직접 **각각의 옵저버들에게 통지**하도록 하는 디자인 패턴

-> 옵저버 패턴은 MVC에서 모델과 뷰 사이를 느슨히 연결하기 위해 사용



- 용어 정리
> Observer는 Subscriber 또는 Listener라고도 불리며, 발행/구독 모델로도 알려져 있다.<br>
> 관찰 대상 == 주제 객체 == Subject<br>
> 관찰자 == 구독 객체 == Subscriber<br>
> 한 주제 객체(subject)의 상태가 바뀌면 다른 구독 객체(Subscriber)에게 상태와 변경을 알린다!



- 일상 예시(어떤 이벤트가 발생했을 때 옵저버들이 바로 반응하는 패턴의 일상 예시)

  - 모닝콜이 울리면 가족 구성원들이 모두 일어나서 침구 정리하고 아침 식사 준비
  - 택배가 도착하면 현관문 앞으로 달려감
  - GUI 프로그램에서 버튼을 클릭하면 관련 함수들이 동작
 
# 사용하는 이유
옵저버 패턴을 가지지 않는다면 이벤트를 체크해야 하는 오브젝트들은 해당 이벤트가 일어나는지 확인하기 위해 주기적으로 계속 확인해야 함

이런 과정을 폴링(polling)이라고 한다.

폴링을 사용하게 되면 필요없는 리소스 단계가 생기기도 하고, 지정해둔 시간 내에 이벤트가 생겼다가 사라지면 이벤트 발생 여부도 알 수 없다.

> ex) 손님들이 마트에 브로콜리가 재입고 되기를 기다리고 있는 상황
> ```
> 폴링: 마트 주인에게 손님들이 시간마다 전화해서 브로콜리 재입고 됐는지 연락
> 옵저버 패턴: 마트 주인이 손님들에게 연락처를 받아 목록에 올려놓고, 브로콜리가 재입고 되면 단체 문자를 보낸다.
> ```


# 구현
![image](https://github.com/AucSuSu/CS-study/assets/75782242/4518a4db-16f1-4661-bd39-9def105bcd75)
1. 관찰이 되는 객체(subject: 이벤트를 발생시키는 주체)에 하나 이상의 옵저버 객체 등록
2. 각각의 옵저버들은 관찰 대상인 객체가 발생시키는 이벤트를 받아서 처리
3. 이벤트가 발생하면 각 옵저버는 콜백(callback)을 받는다. `notify` 함수는 옵저버 자신이 생성한 인자값 전달 가능
4. 각각의 파생 옵저버는 이벤트 발생 시, 처리해야 할 각자의 동작을 `notify` 함수 안에 정의

### 주제 인터페이스와 구현체
```
interface Subject {
	registerObserver() // 옵저버 등록
	removeObserver() // 옵저버 삭제
	notifyObserver() // 옵저버에게 업데이트 알림
}

class SubjectImpl implements Subject {
	registerObserver() { ... }
	removeObserver() { ... }
	notifyObserver() { ... }

	getState() // 주제 객체는 상태를 설정하고 알기위한 겟터,셋터가 있을 수 있다.
	setState()
}
```

### 옵저버 인터페이스와 구현체
```
interface Observer{ // 옵저버가 될 객체에서는 반드시 Observer 인터페이스를 구현해야함.
	update() // 주제의 상태가 바뀌었을때 호출됨
}

class ObserverImpl implements Observer {
	update() { 
		// 주제가 업데이트 될 때 해야하는 일
	}
}
```

- 옵저버의 update() 메서드를 통해 주제의 state를 전달 받지만, 실제 state의 주인은 주제(Subject)에 있음
- 옵저버는 데이터가 변경되었을 때, 주제에서 데이터를 전달해주기를 기다리는 입장이기 때문에 의존성을 가짐
- 옵저버로 인해 느슨한 결합(Loose Coupling)을 가지는 객체 디자인 제공
  - 옵저버를 언제든 새로 추가, 제거 가능
  - 새로운 형식의 옵저버라도 주제를 변경할 필요 X
  - 주제와 옵저버는 서로 독립적으로 재사용 가능
  - 주제나 옵저버가 변경되어도 서로에게 영향 X
